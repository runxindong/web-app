<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>任务管理系统</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root {
            --primary-color: #42b983;
            --error-color: #ff4444;
            --text-color: #2c3e50;
            --border-color: #ddd;
            --bg-color: #f5f5f5;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
        }

        #app {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .task-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: var(--primary-color);
            color: white;
            font-size: 16px;
            transition: opacity 0.3s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-delete {
            background-color: var(--error-color);
        }

        .task-list {
            display: grid;
            gap: 10px;
        }

        .task-item {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .task-item.completed {
            opacity: 0.7;
        }

        .task-item.completed .task-content {
            text-decoration: line-through;
        }

        .task-content {
            flex: 1;
        }

        .task-actions {
            display: flex;
            gap: 5px;
        }

        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--primary-color);
            border-radius: 4px;
            background-color: white;
            color: var(--primary-color);
            cursor: pointer;
        }

        .filter-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        .task-stats {
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-color);
        }

        [v-cloak] {
            display: none;
        }
    </style>
</head>
<body>
    <div id="app" v-cloak>
        <div class="header">
            <h1>{{ title }}</h1>
            <div class="task-form">
                <input 
                    v-model="newTask" 
                    @keyup.enter="addTask"
                    class="input" 
                    type="text" 
                    placeholder="输入新任务..."
                >
                <button @click="addTask" class="btn">添加任务</button>
            </div>
            <div class="filters">
                <button 
                    v-for="filter in filters"
                    :key="filter.value"
                    @click="currentFilter = filter.value"
                    :class="['filter-btn', { active: currentFilter === filter.value }]"
                >
                    {{ filter.label }}
                </button>
            </div>
        </div>

        <div v-if="loading" class="loading">加载中...</div>
        
        <div v-else class="task-list">
            <div 
                v-for="task in filteredTasks" 
                :key="task.id"
                :class="['task-item', { completed: task.completed }]"
            >
                <input 
                    type="checkbox" 
                    v-model="task.completed"
                    @change="toggleTask(task)"
                >
                <span class="task-content">{{ task.title }}</span>
                <div class="task-actions">
                    <button 
                        @click="deleteTask(task)"
                        class="btn btn-delete"
                    >
                        删除
                    </button>
                </div>
            </div>
        </div>

        <div class="task-stats">
            <p>总任务数: {{ tasks.length }}</p>
            <p>已完成: {{ completedCount }}</p>
            <p>未完成: {{ pendingCount }}</p>
        </div>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;

        createApp({
            setup() {
                // 响应式状态
                const title = ref('任务管理系统');
                const tasks = ref([]);
                const newTask = ref('');
                const loading = ref(true);
                const currentFilter = ref('all');

                // 过滤器选项
                const filters = [
                    { label: '全部', value: 'all' },
                    { label: '待完成', value: 'pending' },
                    { label: '已完成', value: 'completed' }
                ];

                // 计算属性
                const filteredTasks = computed(() => {
                    switch (currentFilter.value) {
                        case 'pending':
                            return tasks.value.filter(task => !task.completed);
                        case 'completed':
                            return tasks.value.filter(task => task.completed);
                        default:
                            return tasks.value;
                    }
                });

                const completedCount = computed(() => 
                    tasks.value.filter(task => task.completed).length
                );

                const pendingCount = computed(() => 
                    tasks.value.filter(task => !task.completed).length
                );

                // 方法
                const loadTasks = async () => {
                    loading.value = true;
                    try {
                        // 模拟异步加载
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        const savedTasks = localStorage.getItem('tasks');
                        if (savedTasks) {
                            tasks.value = JSON.parse(savedTasks);
                        }
                    } catch (error) {
                        console.error('加载任务失败:', error);
                    } finally {
                        loading.value = false;
                    }
                };

                const saveTasks = async () => {
                    try {
                        localStorage.setItem('tasks', JSON.stringify(tasks.value));
                    } catch (error) {
                        console.error('保存任务失败:', error);
                    }
                };

                const addTask = async () => {
                    if (!newTask.value.trim()) return;

                    const task = {
                        id: Date.now(),
                        title: newTask.value,
                        completed: false
                    };

                    tasks.value.push(task);
                    await saveTasks();
                    newTask.value = '';
                };

                const toggleTask = async (task) => {
                    task.completed = !task.completed;
                    await saveTasks();
                };

                const deleteTask = async (task) => {
                    const index = tasks.value.findIndex(t => t.id === task.id);
                    if (index > -1) {
                        tasks.value.splice(index, 1);
                        await saveTasks();
                    }
                };

                // 生命周期钩子
                loadTasks();

                return {
                    title,
                    tasks,
                    newTask,
                    loading,
                    currentFilter,
                    filters,
                    filteredTasks,
                    completedCount,
                    pendingCount,
                    addTask,
                    toggleTask,
                    deleteTask
                };
            }
        }).mount('#app');
    </script>
</body>
</html> 